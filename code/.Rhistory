scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " %")) +
coord_cartesian(ylim = c(0, 50)) +
labs(x = NULL,
y = NULL,
color = NULL,
title = "TOWT model fitting accuracy",
subtitle = "CV(RMSE)") +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.direction = "horizontal",
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
cvrmse %>%
ggplot(aes(x = method, y = cvrmse, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
annotate(geom = "text",
x = 1.5,
y = 40,
size = 4,
label = paste0("P value = ", round(result, digits = 3))) +
geom_errorbarh(aes(xmin = 1.2, xmax = 1.8, y = 38), height = 2, linewidth = 0.25) +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(cvrmse, na.rm = T)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
geom_hline(yintercept = 25, color = "red", lty = "dashed") +
annotate(geom = "text",
x = 0.5,
y = 27,
size = 4,
color = "red",
label = paste0(25, " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80")) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " %")) +
coord_cartesian(ylim = c(0, 50)) +
labs(x = NULL,
y = NULL,
color = NULL,
title = "TOWT model fitting accuracy",
subtitle = "CV(RMSE)") +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.direction = "horizontal",
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
cvrmse %>%
ggplot(aes(x = method, y = cvrmse, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
annotate(geom = "text",
x = 1.5,
y = 40,
size = 4,
label = paste0("P value = ", round(result, digits = 3))) +
geom_errorbarh(aes(xmin = 1.2, xmax = 1.8, y = 38), height = 2, linewidth = 0.25) +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(cvrmse, na.rm = T)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
geom_hline(yintercept = 25, color = "red", lty = "dashed") +
annotate(geom = "text",
x = 0.5,
y = 27,
size = 4,
color = "red",
label = paste0(25, " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80")) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " %")) +
coord_cartesian(ylim = c(0, 50)) +
labs(x = NULL,
y = NULL,
color = NULL,
title = "TOWT model fitting accuracy",
subtitle = "CV(RMSE)") +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.direction = "horizontal",
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
result <- t.test(filter(cvrmse, method == "Randomized")$cvrmse,
filter(cvrmse, method == "Conventional")$cvrmse,
exact = TRUE,
alternative = "less",
mu = 0,
conf.int = TRUE,
conf.level = 0.95,
var.equal = TRUE)$p.value
cvrmse %>%
ggplot(aes(x = method, y = cvrmse, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
annotate(geom = "text",
x = 1.5,
y = 40,
size = 4,
label = paste0("P value = ", round(result, digits = 3))) +
geom_errorbarh(aes(xmin = 1.2, xmax = 1.8, y = 38), height = 2, linewidth = 0.25) +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(cvrmse, na.rm = T)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
geom_hline(yintercept = 25, color = "red", lty = "dashed") +
annotate(geom = "text",
x = 0.5,
y = 27,
size = 4,
color = "red",
label = paste0(25, " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80")) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " %")) +
coord_cartesian(ylim = c(0, 50)) +
labs(x = NULL,
y = NULL,
color = NULL,
title = "TOWT model fitting accuracy",
subtitle = "CV(RMSE)") +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.direction = "horizontal",
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
result <- t.test(filter(cvrmse, method == "Randomized")$cvrmse,
filter(cvrmse, method == "Conventional")$cvrmse,
exact = TRUE,
alternative = "less",
mu = 0,
conf.int = TRUE,
conf.level = 0.90,
var.equal = TRUE)$p.value
cvrmse %>%
ggplot(aes(x = method, y = cvrmse, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
annotate(geom = "text",
x = 1.5,
y = 40,
size = 4,
label = paste0("P value = ", round(result, digits = 3))) +
geom_errorbarh(aes(xmin = 1.2, xmax = 1.8, y = 38), height = 2, linewidth = 0.25) +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(cvrmse, na.rm = T)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
geom_hline(yintercept = 25, color = "red", lty = "dashed") +
annotate(geom = "text",
x = 0.5,
y = 27,
size = 4,
color = "red",
label = paste0(25, " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80")) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " %")) +
coord_cartesian(ylim = c(0, 50)) +
labs(x = NULL,
y = NULL,
color = NULL,
title = "TOWT model fitting accuracy",
subtitle = "CV(RMSE)") +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.direction = "horizontal",
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
source("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code/graphical.R", echo=TRUE)
#### LIBRARIES ####
require(pacman)
# load packages using pacman
pacman::p_load(tidyverse, lubridate, here, stats, zoo, scales, lvplot, ggpubr, gridExtra, patchwork, RColorBrewer)
# turn off scientific notation
options(scipen = 999, digits = 15)
# set directory
here::i_am("manuscript.rmd")
# set default theme for ggplot
theme_set(theme_minimal())
setwd("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code")
source("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code/graphical.R", echo=TRUE)
# plot for the stable subset
rand_eob_S <- df_seq_fs_stable %>%
filter(seq == "eob") %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - fs,
method = "rand_eob") %>%
select(name, method, diff)
conv_S <- df_fs_stable %>%
filter(method != "rand") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_S <- df_fs_stable %>%
filter(method != "conv") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - rand,
method = "rand_final") %>%
select(name, method, diff)
df_MW_S <- rbind(rand_eob_S, conv_S, rand_final_S)
# plot for the variable subset
rand_eob_V <- df_seq_fs_variable %>%
filter(seq == "eob") %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site"))%>%
mutate(diff = savings - fs,
method = "rand_eob") %>%
select(name, method, diff)
conv_V <- df_fs_variable %>%
filter(method != "rand") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_V <- df_fs_variable %>%
filter(method != "conv") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - rand,
method = "rand_final") %>%
select(name, method, diff)
df_MW_V <- rbind(rand_eob_V, conv_V, rand_final_V)
# plot for combined dataset
rand_eob_A <- bind_rows(rand_eob_V, rand_eob_S) %>%
select(name, rand_eob_diff = diff)
conv_A <- bind_rows(conv_V, conv_S) %>%
select(name, conv_diff = diff)
rand_final_A <- bind_rows(rand_final_V, rand_final_S) %>%
select(name, rand_final_diff = diff)
df_MW_A <- rand_eob_A %>%
left_join(conv_A, by = "name") %>%
left_join(rand_final_A, by = "name") %>%
pivot_longer(c(rand_eob_diff, conv_diff, rand_final_diff), names_to = "method", values_to = "diff")
p_top <- df_MW_A %>%
mutate(method = as.factor(method),
method = recode_factor(method, "conv_diff" = "Conventional", "rand_eob_diff" = "Randomized", "rand_final_diff" = "Randomized\n(24 months)")) %>%
ggplot(aes(x = method, y = diff, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
geom_hline(yintercept = 0, color = "#fb8072", linewidth = 1.5, lty = "dashed") +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(diff)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 1), " %"))) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix = " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80", "grey80")) +
labs(fill = NULL,
color = NULL,
x = NULL,
y = "Mean error in fractional savings",
subtitle = str_glue("All {A_building} buildings with measured weather")) +
coord_cartesian(ylim = c(-20, 20)) +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.position = "none",
axis.text.x = element_blank(),
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
# TMY
# plot for the stable subset
rand_eob_S <- df_sprt_all_stable %>%
filter(seq == "eob") %>%
select(-c(seq, n_weeks)) %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - annual,
method = "rand_eob") %>%
select(name, method, diff)
conv_S <- df_fs_tmy_stable %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_S <- df_fs_tmy_stable %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - rand,
method = "rand_final") %>%
select(name, method, diff)
df_TW_S <- rbind(rand_eob_S, conv_S, rand_final_S)
# plot for the variable subset
rand_eob_V <- df_sprt_all_variable %>%
filter(seq == "eob") %>%
select(-c(seq, n_weeks)) %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - annual,
method = "rand_eob") %>%
select(name, method, diff)
conv_V <- df_fs_tmy_variable %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_V <- df_fs_tmy_variable %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - rand,
method = "rand_final") %>%
select(name, method, diff)
df_TW_V <- rbind(rand_eob_V, conv_V, rand_final_V)
# plot for combined dataset
rand_eob_A <- bind_rows(rand_eob_V, rand_eob_S) %>%
select(name, rand_eob_diff = diff)
conv_A <- bind_rows(conv_V, conv_S) %>%
select(name, conv_diff = diff)
rand_final_A <- bind_rows(rand_final_V, rand_final_S) %>%
select(name, rand_final_diff = diff)
df_TW_A <- rand_eob_A %>%
left_join(conv_A, by = "name") %>%
left_join(rand_final_A, by = "name") %>%
pivot_longer(c(rand_eob_diff, conv_diff, rand_final_diff), names_to = "method", values_to = "diff")
p_middle <- df_TW_A %>%
mutate(method = as.factor(method),
method = recode_factor(method, "conv_diff" = "Conventional", "rand_eob_diff" = "Randomized", "rand_final_diff" = "Randomized\n(24 months)")) %>%
ggplot(aes(x = method, y = diff, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
geom_hline(yintercept = 0, color = "#fb8072", linewidth = 1.5, lty = "dashed") +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(diff)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 1), " %"))) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix = " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80", "grey80")) +
labs(fill = NULL,
x = NULL,
y = "Mean error in fractional savings",
subtitle = str_glue("All {A_building} buildings with TOWT model and TMY weather")) +
coord_cartesian(ylim = c(-20, 20)) +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
ggarrange(p_top, p_middle,
ncol = 1, nrow = 2,
labels = c("a)", "b)")) +
plot_annotation(title = "Mean error in savings estimation by different M&V methods")
ggarrange(p_top, p_middle,
ncol = 1, nrow = 2,
labels = c("a)", "b)")) +
plot_annotation(title = "Mean error in savings estimation by different M&V methods")
# plot for the stable subset
rand_eob_S <- df_seq_fs_stable %>%
filter(seq == "eob") %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - fs,
method = "rand_eob") %>%
select(name, method, diff)
conv_S <- df_fs_stable %>%
filter(method != "rand") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_S <- df_fs_stable %>%
filter(method != "conv") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - rand,
method = "rand_final") %>%
select(name, method, diff)
df_MW_S <- rbind(rand_eob_S, conv_S, rand_final_S)
# plot for the variable subset
rand_eob_V <- df_seq_fs_variable %>%
filter(seq == "eob") %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site"))%>%
mutate(diff = savings - fs,
method = "rand_eob") %>%
select(name, method, diff)
conv_V <- df_fs_variable %>%
filter(method != "rand") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_V <- df_fs_variable %>%
filter(method != "conv") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - rand,
method = "rand_final") %>%
select(name, method, diff)
df_MW_V <- rbind(rand_eob_V, conv_V, rand_final_V)
# plot for combined dataset
rand_eob_A <- bind_rows(rand_eob_V, rand_eob_S) %>%
select(name, rand_eob_diff = diff)
conv_A <- bind_rows(conv_V, conv_S) %>%
select(name, conv_diff = diff)
rand_final_A <- bind_rows(rand_final_V, rand_final_S) %>%
select(name, rand_final_diff = diff)
df_MW_A <- rand_eob_A %>%
left_join(conv_A, by = "name") %>%
left_join(rand_final_A, by = "name") %>%
pivot_longer(c(rand_eob_diff, conv_diff, rand_final_diff), names_to = "method", values_to = "diff")
p_top <- df_MW_A %>%
mutate(method = as.factor(method),
method = recode_factor(method, "conv_diff" = "Conventional", "rand_eob_diff" = "Randomized", "rand_final_diff" = "Randomized\n(24 months)")) %>%
ggplot(aes(x = method, y = diff, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
geom_hline(yintercept = 0, color = "#fb8072", linewidth = 1.5, lty = "dashed") +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(diff)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 1), " %"))) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix = " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80", "grey80")) +
labs(fill = NULL,
color = NULL,
x = NULL,
y = "Mean error in fractional savings",
subtitle = str_glue("All {A_building} buildings with measured weather")) +
coord_cartesian(ylim = c(-20, 20)) +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.position = "none",
axis.text.x = element_blank(),
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
# TMY
# plot for the stable subset
rand_eob_S <- df_sprt_all_stable %>%
filter(seq == "eob") %>%
select(-c(seq, n_weeks)) %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - annual,
method = "rand_eob") %>%
select(name, method, diff)
conv_S <- df_fs_tmy_stable %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_S <- df_fs_tmy_stable %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - rand,
method = "rand_final") %>%
select(name, method, diff)
df_TW_S <- rbind(rand_eob_S, conv_S, rand_final_S)
# plot for the variable subset
rand_eob_V <- df_sprt_all_variable %>%
filter(seq == "eob") %>%
select(-c(seq, n_weeks)) %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - annual,
method = "rand_eob") %>%
select(name, method, diff)
conv_V <- df_fs_tmy_variable %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - conv,
method = "conv") %>%
select(name, method, diff)
rand_final_V <- df_fs_tmy_variable %>%
left_join(df_fs_variable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - rand,
method = "rand_final") %>%
select(name, method, diff)
df_TW_V <- rbind(rand_eob_V, conv_V, rand_final_V)
# plot for combined dataset
rand_eob_A <- bind_rows(rand_eob_V, rand_eob_S) %>%
select(name, rand_eob_diff = diff)
conv_A <- bind_rows(conv_V, conv_S) %>%
select(name, conv_diff = diff)
rand_final_A <- bind_rows(rand_final_V, rand_final_S) %>%
select(name, rand_final_diff = diff)
df_TW_A <- rand_eob_A %>%
left_join(conv_A, by = "name") %>%
left_join(rand_final_A, by = "name") %>%
pivot_longer(c(rand_eob_diff, conv_diff, rand_final_diff), names_to = "method", values_to = "diff")
p_middle <- df_TW_A %>%
mutate(method = as.factor(method),
method = recode_factor(method, "conv_diff" = "Conventional", "rand_eob_diff" = "Randomized", "rand_final_diff" = "Randomized\n(24 months)")) %>%
ggplot(aes(x = method, y = diff, fill = method)) +
geom_jitter(width = 0.2, alpha = 0.8, size = 0.5) +
geom_lv(k = 4, outlier.shape = NA) +
geom_boxplot(outlier.alpha = 0, coef = 0, fill = "#00000000", aes(color = method)) +
geom_hline(yintercept = 0, color = "#fb8072", linewidth = 1.5, lty = "dashed") +
geom_text(data = . %>% group_by(method) %>% summarise(mean = mean(diff)) %>% ungroup(),
aes(x = method, y = mean, label = paste0(round(mean, digits = 1), " %"))) +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix = " %")) +
scale_fill_manual(values = ls_colors) +
scale_color_manual(values = c("grey80", "grey80", "grey80")) +
labs(fill = NULL,
x = NULL,
y = "Mean error in fractional savings",
subtitle = str_glue("All {A_building} buildings with TOWT model and TMY weather")) +
coord_cartesian(ylim = c(-20, 20)) +
theme(panel.grid.major.y = element_line(color = "grey80", linewidth = 0.25),
legend.position = "none",
plot.margin = margin(t = 2, r = 7, b = 2, l = 2, unit = "mm"))
ggarrange(p_top, p_middle,
ncol = 1, nrow = 2,
labels = c("a)", "b)")) +
plot_annotation(title = "Mean error in savings estimation by different M&V methods")
# plot for the stable subset
rand_eob_S <- df_seq_fs_stable %>%
filter(seq == "eob") %>%
left_join(df_fs_stable %>% filter(scenario == "ref" & method == "true"), by = c("name", "site")) %>%
mutate(diff = savings - fs,
method = "rand_eob") %>%
select(name, method, diff)
conv_S <- df_fs_stable %>%
filter(method != "rand") %>%
pivot_wider(names_from = method, values_from = savings) %>%
mutate(diff = true - conv,
method = "conv") %>%
select(name, method, diff)
View(conv_S)
View(df_fs_stable)
View(df_fs_variable)
source("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code/1_analysis.R", echo=TRUE)
View(df_fs)
source("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code/1_analysis.R", echo=TRUE)
source("~/Documents/Mac/ClassMaterial/ARCH299/Genome/cbe_genome_mnv/code/graphical.R", echo=TRUE)
