x = NULL,
y = NULL) +
theme(panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_text(size = 12),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1.5))
means <- df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
group_by(site) %>%
summarise(mean = mean(frac_saving, na.rm = T)) %>%
ungroup()
p2 <- df_daily %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
ggplot() +
geom_boxplot(aes(x = site, y = frac_saving), outlier.shape = NA) +
geom_text(data = means, aes(x = site, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 5),
labels = number_format(suffix = " %")) +
labs(subtitle = "For each site",
x = NULL,
y = NULL) +
theme(panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_blank())
p2 <- df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
ggplot() +
geom_boxplot(aes(x = site, y = frac_saving), outlier.shape = NA) +
geom_text(data = means, aes(x = site, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 5),
labels = number_format(suffix = " %")) +
labs(subtitle = "For each site",
x = NULL,
y = NULL) +
theme(panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_blank())
ggarrange(p1, p2,
nrow = 1,
widths = c(3, 1),
align = "hv") +
plot_annotation(title = "Estimated daily fractional energy savings")
View(df_baseline)
df_peak
df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland"))
p1 <- df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
ggplot() +
geom_boxplot(aes(x = install, y = frac_saving), outlier.shape = NA) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 5),
labels = number_format(suffix = " %")) +
labs(subtitle = "For individual unit",
x = NULL,
y = NULL) +
theme(panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_text(size = 12),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1.5))
means <- df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
group_by(site) %>%
summarise(mean = mean(frac_saving, na.rm = T)) %>%
ungroup()
p2 <- df_peak %>%
filter(schedule == 2) %>%
left_join(df_baseline, by = "install") %>%
mutate(frac_saving = (baseline - energy) / baseline * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
ggplot() +
geom_boxplot(aes(x = site, y = frac_saving), outlier.shape = NA) +
geom_text(data = means, aes(x = site, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 5),
labels = number_format(suffix = " %")) +
labs(subtitle = "For each site",
x = NULL,
y = NULL) +
theme(panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_blank())
ggarrange(p1, p2,
nrow = 1,
widths = c(3, 1),
align = "hv") +
plot_annotation(title = "Estimated daily fractional energy savings")
# fractional energy savings calculation
df_peak <- df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup()
df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup()
df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup() %>%
pivot_wider(names_from = "install", values_from = "mean")
df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup()
# fractional energy savings calculation
df_peak <- df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup()
View(df_peak)
# fractional energy savings calculation
df_peak <- df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup() %>%
pivot_wider(names_from = "schedule", values_from = "mean")
View(df_peak)
# fractional energy savings calculation
df_peak <- df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup() %>%
pivot_wider(names_from = "schedule", values_from = "mean", names_prefix = "schedule_") %>%
mutate(frac_saving = (schedule_1 - schedule_2) / schedule_1 * 100)
View(df_peak)
# fractional energy savings calculation
df_peak <- df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(date, schedule, install, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
group_by(schedule, install, site) %>%
summarise(mean = mean(energy)) %>%
ungroup() %>%
pivot_wider(names_from = "schedule", values_from = "mean", names_prefix = "schedule_") %>%
mutate(frac_saving = (schedule_1 - schedule_2) / schedule_1 * 100,
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland"))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving)) +
facet_wrap(~site, nrow = 2)
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2)
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x")
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0), labels = number_format(suffix =" W")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 5),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 3),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
geom_hline(aes(yintercept = mean(frac_saving), color = "red", lty = "dashed") +
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving), color = "red", lty = "dashed")) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving), color = "red", lty = "dashed")) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving, group = site), color = "red", lty = "dashed")) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving, na.rm = T), group = site), color = "red", lty = "dashed") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving, na.rm = T), group = site), color = "red", lty = "dashed") +
geom_text(aes(x = 5.5, y = mean(frac_saving, na.rm = T, label = mean(frac_saving)))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving, na.rm = T), group = site), color = "red", lty = "dashed") +
geom_text(aes(x = 5.5, y = mean(frac_saving, na.rm = T), label = mean(frac_saving))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(aes(yintercept = mean(frac_saving, na.rm = T), group = site), color = "red", lty = "dashed") +
geom_text(aes(x = 5.5, y = mean(frac_saving, na.rm = T), label = mean(frac_saving, na.rm = T))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
mean_peak <- df_peak %>%
group_by(site) %>%
summarise(mean = mean(frac_saving, na.rm = T)) %>%
ungroup()
mean_peak
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 5.5, y = mean, label = paste0(round(mean, digits = 0), " %"))) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 5.5, y = mean, label = paste0(round(mean, digits = 0), " %")), color = "red") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 5.5, y = mean + 1, label = paste0(round(mean, digits = 0), " %")), color = "red") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 5.5, y = mean + 2, label = paste0(round(mean, digits = 0), " %")), color = "red") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 6, y = mean + 3, label = paste0(round(mean, digits = 0), " %")), color = "red") +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 6, y = mean, label = paste0(round(mean, digits = 0), " %")), color = "red", position = position_nudge(y = 3)) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(subtitle = "hpwh energy consumption comparison",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
ggsave(filename = "frac_Epeak_saving_distr.png", path = figs_path, units = "in", width = 10, height = 6, dpi = 300)
df_peak %>%
ggplot() +
geom_bar(aes(x = install, y = frac_saving), stat = "identity", position = "dodge") +
geom_hline(data = mean_peak, aes(yintercept = mean, group = site), color = "red", lty = "dashed") +
geom_text(data = mean_peak, aes(x = 6, y = mean, label = paste0(round(mean, digits = 0), " %")), color = "red", position = position_nudge(y = 3)) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_y_continuous(expand = c(0, 0),
breaks = breaks_pretty(n = 4),
labels = number_format(suffix =" %")) +
labs(title = "Mean fractional energy savings during 4 PM - 9 PM",
x = NULL, y = NULL, colour = NULL) +
theme(panel.grid.major.y = element_line(colour = "grey80", linewidth = 0.25),
legend.position = "bottom",
axis.text = element_text(size = 12))
ggsave(filename = "frac_Epeak_saving_distr.png", path = figs_path, units = "in", width = 10, height = 6, dpi = 300)
# boxplot showing the mean for all units
df_5 %>%
mutate(hour = hour(datetime)) %>%
filter(hour >= 16 & hour <= 21) %>%
group_by(install, date, schedule, site) %>%
summarise(energy = sum(power) * (5/60) / 1000) %>%
ungroup() %>%
mutate(schedule = as.factor(schedule),
schedule = recode_factor(schedule, "1" = "Baseline", "2" = "Intervention"),
site = as.factor(site),
site = recode_factor(site, "sj" = "San Jose", "wl" = "Woodland")) %>%
ggplot() +
geom_boxplot(aes(x = install, y = energy, fill = schedule)) +
facet_wrap(~site, nrow = 2, scales = "free_x") +
scale_fill_manual(values = ls_colors) +
scale_y_continuous(breaks = breaks_pretty(n = 3),
labels = number_format(suffix = " kWh")) +
labs(title = str_glue("Daily mean energy use distribution between 4 PM - 9 PM"),
x = NULL,
y = NULL,
fill = NULL) +
theme(legend.position = "bottom",
panel.grid.major.y = element_line(),
plot.margin = margin(t = 2, r = 2, b = 2, l = 2, unit = "mm"),
axis.text = element_text(size = 12))
knitr::include_graphics(paste0(fig_path, "frac_Epeak_saving_distr.png"))
